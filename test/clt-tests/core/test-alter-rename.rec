––– input –––
searchd; if timeout 10 grep -qm1 'accepting' <(tail -n 1000 -f /var/log/manticore/searchd.log); then echo 'Started'; else echo 'Timeout or failed!'; fi
––– output –––
Manticore %{SEMVER} %{COMMITDATE}#!/(\sdev)?\s/!#(columnar %{SEMVER} %{COMMITDATE}) (secondary %{SEMVER} %{COMMITDATE}) (knn %{SEMVER} %{COMMITDATE})
Copyright (c) 2001-2016, Andrew Aksyonoff
Copyright (c) 2008-2016, Sphinx Technologies Inc (http://sphinxsearch.com)
Copyright (c) 2017-%{YEAR}, Manticore Software LTD (https://manticoresearch.com)
[#!/[0-9]{2}:[0-9]{2}.[0-9]{3}/!#] [#!/[0-9]+/!#] using config file '/etc/manticoresearch/manticore.conf' (%{NUMBER} chars)...
starting daemon version '%{SEMVER} %{COMMITDATE}#!/(\sdev)?\s/!#(columnar %{SEMVER} %{COMMITDATE}) (secondary %{SEMVER} %{COMMITDATE}) (knn %{SEMVER} %{COMMITDATE})' ...
listening on %{IPADDR}:9312 for sphinx and http(s)
listening on %{IPADDR}:9306 for mysql
listening on %{IPADDR}:9308 for sphinx and http(s)
Started
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index1(f text, s string); insert into index1 values(1,'abc','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index2(f text, s string); insert into index2 values(2,'def','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index3(f text, s string); insert into index3 values(3,'ghi','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index4(f text, s string); insert into index4 values(4,'jkl','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES"
––– output –––
+--------+------+
| Index  | Type |
+--------+------+
| index1 | rt   |
| index2 | rt   |
| index3 | rt   |
| index4 | rt   |
+--------+------+
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE index1 RENAME new_index1;"
––– output –––
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE index2 RENAME new_index2;"
––– output –––
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE index3 RENAME new_index3;"
––– output –––
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE index4 RENAME new_index4;"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES"
––– output –––
+------------+------+
| Index      | Type |
+------------+------+
| new_index1 | rt   |
| new_index2 | rt   |
| new_index3 | rt   |
| new_index4 | rt   |
+------------+------+
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index1(f text, s string); insert into index1 values(3,'ghi','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE index2(f text, s string); insert into index2 values(4,'jkl','string');"
––– output –––
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE dist_table type='distributed' local='index1' local='index2';"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES; DESC dist_table"
––– output –––
+------------+-------------+
| Index      | Type        |
+------------+-------------+
| dist_table | distributed |
| index1     | rt          |
| index2     | rt          |
| new_index1 | rt          |
| new_index2 | rt          |
| new_index3 | rt          |
| new_index4 | rt          |
+------------+-------------+
+--------+-------+
| Agent  | Type  |
+--------+-------+
| index1 | local |
| index2 | local |
+--------+-------+
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE dist_table RENAME new_dist_table;"
––– output –––
ERROR 1064 (42000) at line 1: Source table dist_table not exists
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES"
––– output –––
+------------+-------------+
| Index      | Type        |
+------------+-------------+
| dist_table | distributed |
| index1     | rt          |
| index2     | rt          |
| new_index1 | rt          |
| new_index2 | rt          |
| new_index3 | rt          |
| new_index4 | rt          |
+------------+-------------+
––– input –––
mysql -h0 -P9306 -e "CREATE TABLE products(title text, meta json) type='pq';"
––– output –––
––– input –––
mysql -h0 -P9306 -e "SHOW TABLES"
––– output –––
+------------+-------------+
| Index      | Type        |
+------------+-------------+
| dist_table | distributed |
| index1     | rt          |
| index2     | rt          |
| new_index1 | rt          |
| new_index2 | rt          |
| new_index3 | rt          |
| new_index4 | rt          |
| products   | percolate   |
+------------+-------------+
––– input –––
mysql -h0 -P9306 -e "ALTER TABLE products RENAME new_products;"
––– output –––
ERROR 1064 (42000) at line 1: Source table products not exists
