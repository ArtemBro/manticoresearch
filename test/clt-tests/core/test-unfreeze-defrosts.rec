––– block: ../base/start-searchd –––
––– input –––
set -b +m
––– output –––
––– input –––
mysql -h0 -P9306 -e "drop table if exists t; create table t(f text, s string) rt_mem_limit='128k'; insert into t values(0,'abc','string'); freeze t;" > /dev/null 2>&1
––– output –––
––– input –––
for n in `seq 1 10000`; do mysql -h0 -P9306 -e "insert into t values(0, 'abc', 'string string string stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring stringstring string');"; done &
––– output –––
––– input –––
sleep 7; mysql -h0 -P9306 -e "select count(*) from t\G; unfreeze t;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 3; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 2; mysql -h0 -P9306 -e "freeze t;" > /dev/null 2>&1
––– output –––
––– input –––
sleep 7; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 3; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
––– input –––
mysql -h0 -P9306 -e "unfreeze t;"
––– output –––
––– input –––
sleep 3; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 3; mysql -h0 -P9306 -e "freeze t; freeze t;" > /dev/null 2>&1
––– output –––
––– input –––
sleep 3; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 7; mysql -h0 -P9306 -e "select count(*) from t\G; unfreeze t; unfreeze t;"
––– output –––
*************************** 1. row ***************************
––– input –––
sleep 3; mysql -h0 -P9306 -e "select count(*) from t\G;"
––– output –––
*************************** 1. row ***************************
